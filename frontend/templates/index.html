<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>离线办公助手</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>离线办公助手</h1>
            <p class="subtitle">语音转文字 | PDF转Word | 图片OCR</p>
        </header>

        <nav class="nav-tabs">
            <button class="tab-btn active" data-tab="asr">语音转文字</button>
            <button class="tab-btn" data-tab="pdf">PDF转Word</button>
            <button class="tab-btn" data-tab="ocr">图片OCR</button>
        </nav>

        <main class="main-content">
            <!-- 语音转文字模块 -->
            <section id="asr-section" class="tool-section active">
                <div class="upload-area" id="asr-upload">
                    <div class="upload-icon">🎤</div>
                    <p>拖拽音频文件到此处，或点击选择文件</p>
                    <p class="upload-hint">支持格式: MP3, WAV, M4A, FLAC, OGG</p>
                    <input type="file" id="asr-file" accept=".mp3,.wav,.m4a,.flac,.ogg,.mp4" hidden>
                </div>
                <div class="options-panel">
                    <div class="option-item">
                        <label for="asr-language">语言:</label>
                        <select id="asr-language">
                            <option value="">自动检测</option>
                            <option value="zh">中文</option>
                            <option value="en">英文</option>
                            <option value="ja">日文</option>
                            <option value="ko">韩文</option>
                        </select>
                    </div>
                </div>
                <div class="file-info" id="asr-file-info"></div>
                <button class="action-btn" id="asr-convert" disabled>开始转换</button>
                <div class="progress-container" id="asr-progress" hidden>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <span class="progress-text">处理中...</span>
                </div>
                <div class="result-area" id="asr-result" hidden>
                    <h3>转换结果</h3>
                    <div class="result-text"></div>
                    <div class="result-actions">
                        <button class="copy-btn">复制文本</button>
                        <button class="download-btn">下载文件</button>
                    </div>
                </div>
            </section>

            <!-- PDF转Word模块 -->
            <section id="pdf-section" class="tool-section">
                <div class="upload-area" id="pdf-upload">
                    <div class="upload-icon">📄</div>
                    <p>拖拽PDF文件到此处，或点击选择文件</p>
                    <p class="upload-hint">支持格式: PDF</p>
                    <input type="file" id="pdf-file" accept=".pdf" hidden>
                </div>
                <div class="options-panel">
                    <div class="option-item">
                        <label for="pdf-start">起始页:</label>
                        <input type="number" id="pdf-start" min="0" value="0" placeholder="从第1页">
                    </div>
                    <div class="option-item">
                        <label for="pdf-end">结束页:</label>
                        <input type="number" id="pdf-end" min="1" placeholder="到最后一页">
                    </div>
                    <div class="option-item">
                        <label for="pdf-dpi">DPI:</label>
                        <select id="pdf-dpi">
                            <option value="150">150 (快速)</option>
                            <option value="300" selected>300 (标准)</option>
                            <option value="600">600 (高清)</option>
                        </select>
                    </div>
                </div>
                <div class="file-info" id="pdf-file-info"></div>
                <button class="action-btn" id="pdf-convert" disabled>开始转换</button>
                <div class="progress-container" id="pdf-progress" hidden>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <span class="progress-text">处理中...</span>
                </div>
                <div class="result-area" id="pdf-result" hidden>
                    <h3>转换结果</h3>
                    <div class="result-info"></div>
                    <div class="result-actions">
                        <button class="download-btn">下载Word文件</button>
                    </div>
                </div>
            </section>

            <!-- 图片OCR模块 -->
            <section id="ocr-section" class="tool-section">
                <div class="upload-area" id="ocr-upload">
                    <div class="upload-icon">🖼️</div>
                    <p>拖拽图片到此处，或点击选择文件</p>
                    <p class="upload-hint">支持格式: JPG, PNG, BMP, TIFF, WEBP</p>
                    <input type="file" id="ocr-file" accept=".jpg,.jpeg,.png,.bmp,.tiff,.tif,.webp,.gif" multiple hidden>
                </div>
                <div class="options-panel">
                    <div class="option-item">
                        <label for="ocr-language">语言:</label>
                        <select id="ocr-language">
                            <option value="ch">中英文</option>
                            <option value="en">英文</option>
                            <option value="chinese_cht">繁体中文</option>
                            <option value="japan">日文</option>
                            <option value="korean">韩文</option>
                        </select>
                    </div>
                </div>
                <div class="file-info" id="ocr-file-info"></div>
                <button class="action-btn" id="ocr-convert" disabled>开始识别</button>
                <div class="progress-container" id="ocr-progress" hidden>
                    <div class="progress-bar">
                        <div class="progress-fill"></div>
                    </div>
                    <span class="progress-text">处理中...</span>
                </div>
                <div class="result-area" id="ocr-result" hidden>
                    <h3>识别结果</h3>
                    <div class="result-text"></div>
                    <div class="result-actions">
                        <button class="copy-btn">复制文本</button>
                        <button class="download-btn">下载文件</button>
                    </div>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>离线办公助手 v1.0.0 | 内网环境使用</p>
        </footer>
    </div>

    <div class="toast" id="toast"></div>

    <script src="/static/js/app.js"></script>
</body>
</html>
